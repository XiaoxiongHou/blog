目录
[1. OSI七层模型和TCP/IP四层模型 1](#_Toc460360431)
[Ø TCP/IP的四层模型 1](#_Toc460360432)
[Ø OSI(Open System Interconnection)七层模型 1](#_Toc460360433)
[2. UDP和TCP的区别 2](#_Toc460360434)
[3. TCP三次握手 2](#_Toc460360435)
[4. TCP三次握手有哪些漏洞，有没有被攻击的可能，怎么被攻击? 2](#_Toc460360436)
[5. 三次握手，为什么需要最后一次握手呢？ 3](#_Toc460360437)
[6. 连接释放时：为什么是两次请求呢？四次握手 3](#_Toc460360438)
[7. A为什么等待2MSL，从TIME_WAIT到CLOSE？ 4](#_Toc460360439)
[8. ARP是什么？ 4](#_Toc460360440)
[9. 各种协议 5](#_Toc460360441)
[10. RARP 5](#_Toc460360442)
[11. HTTP长连接和短连接 5](#_Toc460360443)
[长连接和短连接 5](#_Toc460360444)
[什么时候用长连接和短连接？ 6](#_Toc460360445)
[12. 从输入网址到获得页面的过程 6](#_Toc460360446)
[13. 基本的Http流程 7](#_Toc460360447)
[14. Socket编程 7](#_Toc460360448)
[15. Http与Https的区别 7](#_Toc460360449)
 
1. OSI七层模型和TCP/IP四层模型
OSI：Open System Interconnection 开放系统互连。七层网络模型称为开放式网络互连参考模型；
TCP/IP：Transmission Control Protocol / Internet Protocol 传输控制协议/因特网互连协议。
是最基本的Internet协议，由网络层的IP和传输层的TCP构成。
 

| OSI七层模型 | TCP/IP四层模型 | 对应网络协议 |
| --- | --- | --- |
| 应用层 | 应用层 | TFTP、FTP、NFS、WAIS |
| 表示层 |  | Telnet、SNMP |
| 会话层 |   | SMTP、DNS |
| 传输层 | 传输层 | TCP、UDP |
| 网络层 | 网际层 | IP、ICMP、ARP、RIP |
| 数据链路层 | 网络接口层 | FDDI、Ethernet |
| 物理层 |  | IEEE802.1、IEEE802.2到802.11 |

**Ø  [
     应用层：应用程序间沟通的层，如简单电子邮件传输（SMTP）、文件传输协议（FTP）、网络远程访问协议（Telnet）等。 
     传输层：在此层中，它提供了节点间的数据传送服务，如传输控制协议（TCP）、用户数据报协议（UDP）等，TCP和UDP给数据包加入传输数据并把它传输到下一层中，这一层负责传送确定数据已被送达并接收。
互连网络层：负责提供基本的数据封包传送功能，让每一块数据包都能够到达目的主机（但不检查是否被正确接收），如网际协议（IP）。 
     网络接口层：对实际的网络媒体的管理，定义如何使用实际网络（如Ethernet、Serial Line等）来传送数据。
**Ø 
物理层：主要定义物理设备标准，如网线的接口类型、光纤的接口类型、各种传输介质的传输速率等。它的主要作用是传输比特流（就是由1、0转化为电流强弱 来进行传输,到达目的地后在转化为1、0，也就是我们常说的数模转换与模数转换）。这一层的数据叫做比特。 　　
数据链路层：定义了如何让格式化数据以进行传输，以及如何让控制对物理介质的访问。这一层通常还提供错误检测和纠正，以确保数据的可靠传输。 　　
网络层：在位于不同地理位置的网络中的两个主机系统之间提供连接和路径选择。Internet的发展使得从世界各站点访问信息的用户数大大增加，而网络层正是管理这种连接的层。 　　
传输层：定义了一些传输数据的协议和端口号（WWW端口80等），如：TCP（传输控制协议，传输效率低，可靠性强，用于传输可靠性要求高，数据量大的数据），UDP（[用户数据报协议](http://baike.baidu.com/view/468464.htm)，与TCP特性恰恰相反，用于传输可靠性要求不高，数据量小的数据，如QQ聊天数据就是通过这种方式传输的）。 主要是将从下层接收的数据进行分段和传输，到达目的地址后再进行重组。常常把这一层数据叫做段。 　　
会话层：通过传输层（端口号：传输端口与接收端口）建立数据传输的通路。主要在你的系统之间发起会话或者接受会话请求（设备之间需要互相认识可以是IP也可以是MAC或者是主机名） 　　
表示层：可确保一个系统的应用层所发送的信息可以被另一个系统的应用层读取。例如，PC程序与另一台计算机进行通信，其中一台计算机使用扩展二一十进制 交换码（EBCDIC），而另一台则使用美国信息交换标准码（ASCII）来表示相同的字符。如有必要，表示层会通过使用一种通格式来实现多种数据格式之 间的转换。 　　
应用层： 是最靠近用户的OSI层。这一层为用户的应用程序（例如电子邮件、文件传输和终端仿真）提供网络服务。
**
UDP(User Datagram Protocol):提供无连接的通信，不能保证数据包被发送到目标地址，典型的即时传输少量数据的应用程序通常使用UDP。
TCP全双工的：面向连接的（三次握手） 面向字节流的，有拥塞控制(根据网络的好坏控制报文发送的速率)。面向连接的、可靠的、基于字节流的应用程序提供连接定向和可靠的通信。
① TCP面向连接的传输控制协议，而UDP是没有面向连接的数据报服务；
② TCP高可靠性，确保传输数据的正确性，不会出现丢失或乱序；UDP在传输数据前不建立连接，不对数据报进行检查与修改，无需等待对方的回答，所以会出现分组丢失，重复，乱序，应用程序需要负责传输可靠性方面的所有工作；
③ TCP对系统资源要求多，UDP对系统资源要求少；
④ UDP具有较好的实时性，工作效率较TCP高；
⑤ UDP的段结构比TCP段结构简单，因此网络开销小。
**
第一次握手：主机A发送位码为syn＝1,随机产生seq number=1234567的数据包到服务器，主机B由SYN=1知道，A要求建立联机；
第二次握手：主机B收到请求后要确认联机信息，向A发送ack number=(主机A的seq+1),syn=1,ACK=1,随机产生seq=7654321的包。
第三次握手：主机A收到后检查ack number是否正确，即第一次发送的seq number+1,以及位码ACK是否为1，若正确，主机A会再发送ack number=(主机B的seq+1),ACK=1，主机B收到  后确认seq值与ACK=1则连接建立成功。
完成三次握手，主机A与主机B开始传送数据。
**4. 
答：是有漏洞的，主要是如果收到一个恶意攻击的ip一直请求连接，然后服务器会发送ack确认，但是永远等不到回复，就会导致服务器的NIC(网络适配器)，内存，cpu占用率超载，这种攻击方式叫做基于TCP半开回话的洪水攻击。
DDos攻击：
Step1：客户端向服务端发送连接请求数据包；
Step2：服务端向客户端回复连接请求数据包，然后服务器等待客户端发送tcp/ip连接的第三步数据包；
Step3：如果客户端不向服务端发送最后一个数据包，则服务器必须等待30s到2min的时间才能将连接关闭。
当大量的请求只进行到第二步的时候，而不进行第三步，服务器大量的资源都变成了等待第三个数据包，则造成DDos攻击。
预防DDos的方法：（没有根治的方法，除非不用TCP/IP连接）
①严格限制对外开放的服务器的向外访问；
②确保服务器的系统文件是最新版本，并及时更新系统补丁；
③关闭不必要的服务；
④限制同时打开SYN的半连接数目；
⑤缩短SYN半连接的time out时间；
⑥正确设置防火墙；
⑦禁止对主机的非开放服务的访问；
⑧限制特定IP短地址的访问；
⑨启用防火墙的防DDos的属性.
**
TCP三次握手的过程是：假设主机A为客户端，主机B为服务端。
主机A向B发送连接请求，主机B对收到的主机A的报文段进行确认，主机A再次对主机B的确认进行确认。
采用三次握手是为了防止失效的连接请求报文字段突然又传送到主机B，因而产生错误。已失效的连接请求报文段的产生在这样一种情况下：client发出的第一个连接请求报文段并没有丢失，而是在某个网络结点长时间的滞留了，以致延误到连接释放以后的某个时间才到达server。本来这是一个早已失效的报文段。但server收到此失效的连接请求报文段后，就误认为是client再次发出的一个新的连接请求。于是就向client发出确认报文段，同意建立连接。假设不采用三次握手，那么只要server发出确认，新的连接就建立了。由于现在client并没有发出建立连接的请求，因此不会理睬server的确认，也不会向server发送数据。但server却以为新的运输连接已经建立，并一直等待client发来数据。这样，server的很多资源就白白浪费掉了。采用三次握手的办法可以防止上述现象发生。
**
由于TCP连接是全双工的，因此每个方向上都必须单独进行关闭。
主机A发送关闭请求，主机B确认；主机B发送关闭请求，主机A确认。
① 当主机A确认发送完数据且知道B已经接收完了，想要关闭发送数据口（当然确认信号还是可以发），就会发FIN给主机B。
② 主机B收到A发送的FIN，表示收到了，就会发送ACK回复。
③ 但此时B可能还在发送数据，没有想要关闭数据口的意思，所以FIN与ACK不是同时发送的，而是等到B数据发送完了，才会发送FIN给主机A。
④ A收到B发来的FIN，知道B的数据也发送完了，回复ACK， A等待2MSL以后，没有收到B传来的任何消息，知道B已经收到自己的ACK了，A就关闭链接，B也关闭链

|  | ![](https://cdn.nlark.com/yuque/0/2020/png/223307/1583068137109-4f137d6a-16ed-45b8-abd9-9362f52bca1a.png) |
| --- | --- |

接了。
对于建链接的3次握手，主要是要初始化Sequence Number 的初始值。通信的双方要互相通知对方自己的初始化的Sequence Number（缩写为ISN：Inital Sequence Number）。所以叫SYN，全称Synchronize Sequence Numbers。也就上图中的 x 和 y。这个号要作为以后的数据通信的序号，以保证应用层接收到的数据不会因为网络上的传输的问题而乱序（TCP会用这个序号来拼接数据）。
**
在Client发送出最后的ACK回复，但该ACK可能丢失。Server如果没有收到ACK，将不断重复发送FIN片段。所以Client不能立即关闭，它必须确认Server接收到了该ACK。Client会在发送出ACK之后进入到TIME_WAIT状态。Client会设置一个计时器，等待2MSL的时间。如果在该时间内再次收到FIN，那么Client会重发ACK并再次等待2MSL。所谓的2MSL是两倍的MSL(Maximum Segment Lifetime)。MSL指一个片段在网络中最大的存活时间，2MSL就是一个发送和一个回复所需的最大时间。如果直到2MSL，Client都没有再次收到FIN，那么Client推断ACK已经被成功接收，则结束TCP连接。
**8. 
ARP是地址解析协议，简单语言解释一下工作原理。
① 首先，每个主机都会在自己的ARP缓冲区中建立一个ARP列表，以表示IP地址和MAC地址之间的对应关系。
② 源主机要发送数据时，首先检查ARP列表中是否有对应IP地址的目的主机的MAC地址，如果有，则直接发送数据，如果没有，就向本网段的所有主机发送ARP数据包，该数据包包括的内容有：源主机IP地址，源主机MAC地址，目的主机的IP地址。
③ 当本网络的所有主机收到该ARP数据包时，首先检查数据包中的IP地址是否是自己的IP地址，如果不是，则忽略该数据包，如果是，则首先从数据包中取出源主机的IP和MAC地址写入到ARP列表中，如果已经存在，则覆盖，然后将自己的MAC地址写入ARP响应包中，告诉源主机自己是它想要找的MAC地址。
④ 源主机收到ARP响应包后。将目的主机的IP和MAC地址写入ARP列表，并利用此信息发送数据。如果源主机一直没有收到ARP响应数据包，表示ARP查询失败。
广播发送ARP请求，单播发送ARP响应。
**
ICMP协议：因特网控制报文协议。它是TCP/IP协议族的一个子协议，用于在IP主机、路由器之间传递控制消息。
TFTP协议：是TCP/IP协议族中的一个用来在客户机与服务器之间进行简单文件传输的协议，提供不复杂、开销不大的文件传输服务。
HTTP协议：超文本传输协议，是一个属于应用层的面向对象的协议，由于其简捷、快速的方式，适用于分布式超媒体信息系统。
DHCP协议：动态主机配置协议，是一种让系统得以连接到网络上，并获取所需要的配置参数手段。
NAT协议：网络地址转换属接入广域网(WAN)技术，是一种将私有（保留）地址转化为合法IP地址的转换技术，
DHCP协议：一个局域网的网络协议，使用UDP协议工作，用途：给内部网络或网络服务供应商自动分配IP地址，给用户或者内部网络管理员作为对所有计算机作中央管理的手段。 
**
RARP是逆地址解析协议，作用是完成硬件地址MAC到IP地址的映射，主要用于无盘工作站，因为给无盘工作站配置的IP地址不能保存。工作流程：在网络中配置一台RARP服务器，里面保存着IP地址和MAC地址的映射关系，当无盘工作站启动后，就封装一个RARP数据包，里面有其MAC地址，然后广播到网络上去，当服务器收到请求包后，就查找对应的MAC地址的IP地址装入响应报文中发回给请求者。因为需要广播请求报文，因此RARP只能用于具有广播能力的网络。
**11. 
### **
**在HTTP/1.0中，默认使用的是短连接**。也就是说，浏览器和服务器每进行一次HTTP操作，就建立一次连接，但任务结束就中断连接。如果客户端浏览器访问的某个HTML或其他类型的 Web页中包含有其他的Web资源，如JavaScript文件、图像文件、CSS文件等；当浏览器每遇到这样一个Web资源，就会建立一个HTTP会话。
但从 **HTTP/1.1起，默认使用长连接**，用以保持连接特性。使用长连接的HTTP协议，会在响应头有加入这行代码：
HTTP协议的长连接和短连接，实质上是TCP协议的长连接和短连接。
长连接的情况，client向server发起连接，server接受client连接，双方建立连接。Client与server完成一次读写之后，它们之间的连接并不会主动关闭，后续的读写操作会继续使用这个连接。
长连接：建立连接——数据传输...（保持连接）...数据传输——关闭连接
TCP短连接的情况，client向server发起连接请求，server接到请求，然后双方建立连接。client向server 发送消息，server回应client，然后一次读写就完成了，这时候双方任何一个都可以发起close操作，不过一般都是client先发起 close操作。
短连接：建立连接——数据传输——关闭连接...建立连接——数据传输——关闭连接
### **
**长连接**多用于操作频繁，点对点的通讯，而且连接数不能太多情况，。每个TCP连接都需要三步握手，这需要时间，如果每个操作都是先连接，再操作的话那么处理速度会降低很多，所以每个操作完后都不断开，处理时直接发送数据包就OK了，不用建立TCP连接。例如：数据库的连接用长连接， 如果用短连接频繁的通信会造成socket错误，而且频繁的socket 创建也是对资源的浪费。
而像WEB网站的http服务一般都用**短链接**，因为长连接对于服务端来说会耗费一定的资源，而像WEB网站这么频繁的成千上万甚至上亿客户端的连接用短连接会更省一些资源，如果用长连接，而且同时有成千上万的用户，如果每个用户都占用一个连接的话，那可想而知吧。所以并发量大，但每个用户无需频繁操作情况下需用短连好。
 
HTTP长短连接：Connection:keep-alive
这种方式由于连接一直存在，所以被称为长连接。经常用于P2P通信。
**
Step1：根据输入的网址查询DNS(Domain Name System)，获取域名对应的IP地址；
查询DNS的先后顺序为：浏览器搜索自身的DNS缓存，搜索操作系统的DNS缓存，读取本地的HOST文件，发起一个DNS的系统调用(带宽运营服务器查看本身缓存，运营商服务器发起一个迭代DNS解析请求)。
Step2：浏览器获得域名对应的IP地址后，向目标服务器发起三次握手连接请求；
Step3：TCP/IP连接建立起来之后，浏览器就向服务器发送Http请求；
Step4：服务器接收到请求之后，根据路径参数，经过后端的一些处理生成HTML页面代码返回给浏览器；
Step5：浏览器拿到完整的HTML页面代码开始解析和渲染，如果遇到引用的外部JS，CSS，图片等静态资源，它们同样也是一个一个的Http请求，都需要经过上面的步骤；
Step6：浏览器根据拿到的资源对页面进行渲染，最终把一个完整的页面呈现给用户。
**
Http是Hyper Text Transfer Protocol(超文本传输协议)的缩写，主要负责服务器与浏览器之间的通信。Http把客户端浏览器的请求发送到服务器，并把响应的网页内容由服务器返回到客户端浏览器。
Http协议的特点：
① Http是一种无状态协议；
② Http协议在应用层，在服务器每个Http都需要启动独立的线程去处理；
Http会话有四个过程：
① 客户端与服务器建立tcp连接；
② 客户端向服务器发出请求文档；
③ 服务器向客户端发出响应文档；
④ 释放tcp连接。
**
Socket在计算机中提供了一种通信接口，可以通过这个端口与任何一个具有socket接口的计算机通信，应用程序在网络上传输，接收的信息都通过这个socket接口来实现。
Socket通信原理如下：
服务器端实现监听连接à客户端实现发送连接请求à连接建立à发送和接收数据进行通信。
**
协议 明文 端口 证书 是否简单
http是Http协议运行在TCP之上，所有传输的内容都是明文，客户端和服务端都无法验证对方的身份；
https是HTTP运行在SSL/TLS之上，SSL/TLS运行在TCP之上，所有传输的内容都经过加密处理，加密采用对称加密，但对称加密的秘钥用服务器方的证书进行了非对称加密。此外客户端可以验证服务端的身份，如果配置了客户端验证，服务器方也可以验证客户端的身份；
https协议需要到ca申请证书，一般免费证书很少，需要交费；
http是超文本传输协议，信息明文传输，https则是具有安全性的ssl加密传输协议；
http和https使用的是完全不同的连接方式，用的端口也不一样，前者是80，后者是443；
http的连接很简单，是无状态的；
https协议是由SSL+HTTP协议构建的可进行加密传输，身份认证的网络协议要比http协议更加安全。
**
http://coolshell.cn/articles/11609.html
TCP引入了一些技术和设计来做网络流控，Sliding Window是其中一个技术。 前面我们说过，TCP头里有一个字段叫Window，又叫Advertised-Window，这个字段是接收端告诉发送端自己还有多少缓冲区可以接收数据。于是发送端就可以根据这个接收端的处理能力来发送数据，而不会导致接收端处理不过来。
拥塞控制主要是四个算法：1）慢启动，2）拥塞避免，3）拥塞发生，4）快速恢复。
